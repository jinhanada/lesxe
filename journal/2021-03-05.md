# 2021-03-05

## macro

ようやくLesxe上でマクロを展開できるようになった。

しかしマクロ展開器を書くための構文に乏しく、マクロを書くためにマクロがほしかった。

なんならSchemeなど他のLispでまずLesxe(便利構文あり) -> Lesxe(プリミティブ)のコンパイラを書いて、それでマクロ展開器を書いた方が楽だったかもしれない。もうマクロあるからいいけど……。

しかし次はquasiquoteを早めに書かないとだいぶんきつい。


## REPLの妙な挙動

……は、REPLの挙動ではなく、core.leを読み込んだとき、オブジェクトのアドレスによってはhashが負数返すことによるhash-tableのバグだった。array:getがそのまま負数のインデックスを受け付けてしまっている！

動作が多少速いぐらいならデバッグが楽な方がいいので、ガードを作ることにする。